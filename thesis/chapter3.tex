\chapter{Построение нейросетевого регулятора}

\section{Постановка задачи}
Рассмотрим нелинейную дискретную динамическую систему
\begin{equation} \label{general_task}
x(t+1) = f(x(t), u(t)),
\end{equation} 
где $x(t) \in \mathbb{R}^n$ - вектор состояний, $u(t) \in \mathbb{R}^m$ - вектор управления и $f(0,0) = 0$. Мы рассматриваем ограничения вида 
\begin{equation}
X = \left \{  x \in \mathbb{R}^n | Hx \leq 1_p \right \}, \ U = \left \{ u \in \mathbb{R}^m | Lu \leq 1_q \right \}
\end{equation}


Также необходимо, чтобы выполнялось ограничение $(x(t), u(t)) \in X \times U \ \forall t \geq 0$. 

Будем оптимизировать функцию стоимости $min_{u(\cdot|t)} \sum_{k=0}^{N-1}l(x,u) + V_f(X(N))$
 
\section{Подход к решению}

MPC регулятор, построенный для задачи (\ref{general_task}), робастный по отношению к неточному управлению $u$ в пределах выбранных границ.RMPC дискретизируется по множеству допустимых состояний $X_{feas}$ и аппроксимируется с использованием нейронной сети, основанной на этих точках. Обучение дает апроксимированный MPC $ \pi_{feas} : X_{feas} \to U | u = \pi_{approx} (x)$. С этим регулятором система замкнутого контура задается как $x (t + 1) = f (x (t), \pi_{approx} (x (t)))$.  Стабильность замкнутого контура гарантируется, если погрешность аппроксимации ниже допустимой границы входного возмущения от робастного MPC. Используется метод проверки, основанный на неравенстве Хоэффинга, чтобы гарантировать эту оценку.

TODO 

Попробовать уменьшить кол-во генерируемых точек для гарантирования аппроксимации

Поппробовать более точно вычислить $X_{feas}$ 

Попробовать расспаралеллить получение точек и валидацию аппроксимированной функции нейронной сети

Хотелось бы еще рассмотреть возможность использования unsupervised learning и reinforcement learning 